 1. Inventario de hardware y software
ğŸ”¹ Obtener informaciÃ³n completa de hardware

Get-CimInstance -ClassName Win32_ComputerSystem |
Select-Object Name, Manufacturer, Model, TotalPhysicalMemory
ğŸ”¹ Listar CPU, RAM y discos

Get-CimInstance Win32_Processor | Select-Object Name, NumberOfCores, MaxClockSpeed
Get-CimInstance Win32_PhysicalMemory | Select-Object Manufacturer, Capacity, Speed
Get-CimInstance Win32_DiskDrive | Select-Object Model, InterfaceType, Size
ğŸ”¹ Exportar inventario completo a CSV

$info = [PSCustomObject]@{
    ComputerName = $env:COMPUTERNAME
    CPU          = (Get-CimInstance Win32_Processor).Name
    RAM_GB       = [math]::Round((Get-CimInstance Win32_ComputerSystem).TotalPhysicalMemory / 1GB, 2)
    Disk_GB      = [math]::Round((Get-CimInstance Win32_LogicalDisk -Filter "DeviceID='C:'").Size / 1GB, 2)
    OS           = (Get-CimInstance Win32_OperatingSystem).Caption
}
$info | Export-Csv "C:\temp\inventario.csv" -Append -NoTypeInformation

ğŸŒ 2. AdministraciÃ³n de red
ğŸ”¹ Ver configuraciÃ³n IP completa

Get-CimInstance Win32_NetworkAdapterConfiguration -Filter "IPEnabled=TRUE" |
Select-Object Description, MACAddress, IPAddress, DefaultIPGateway, DNSServerSearchOrder
ğŸ”¹ Comprobar conectividad con WMI Ping

Test-NetConnection -ComputerName 8.8.8.8 -InformationLevel Detailed
ğŸ”¹ Listar adaptadores de red activos

Get-CimInstance Win32_NetworkAdapter -Filter "NetEnabled=TRUE" | Select-Object Name, MACAddress
ğŸ”¹ Obtener el dominio y usuario actual

Get-CimInstance Win32_ComputerSystem | Select-Object Name, Domain, UserName

ğŸ§° 3. Mantenimiento y soporte
ğŸ”¹ Reiniciar equipos remotamente

Restart-Computer -ComputerName PC001,PC002 -Force
ğŸ”¹ Comprobar uptime

(Get-CimInstance Win32_OperatingSystem).LastBootUpTime
ğŸ”¹ Limpiar archivos temporales

Remove-Item "C:\Windows\Temp\*" -Recurse -Force -ErrorAction SilentlyContinue
ğŸ”¹ Consultar espacio libre en disco

Get-CimInstance Win32_LogicalDisk -Filter "DriveType=3" |
Select-Object DeviceID, @{N='FreeGB';E={[math]::Round($_.FreeSpace/1GB,2)}}

ğŸ§© 4. Monitoreo y rendimiento
ğŸ”¹ Uso actual de CPU y memoria

Get-Counter '\Processor(_Total)\% Processor Time','\Memory\Available MBytes'
ğŸ”¹ Top 5 procesos por uso de memoria

Get-Process | Sort-Object WorkingSet -Descending | Select-Object -First 5 Name,WorkingSet
ğŸ”¹ Registrar rendimiento cada minuto

while ($true) {
    $cpu = (Get-Counter '\Processor(_Total)\% Processor Time').CounterSamples.CookedValue
    $mem = (Get-Counter '\Memory\Available MBytes').CounterSamples.CookedValue
    "$((Get-Date).ToString()) - CPU: $cpu%, RAM libre: $mem MB" | Out-File C:\temp\perf_log.txt -Append
    Start-Sleep 60
}

ğŸ” 5. Seguridad y cumplimiento
ğŸ”¹ Listar usuarios locales habilitados

Get-CimInstance Win32_UserAccount -Filter "LocalAccount='True' and Disabled='False'" |
Select-Object Name, SID
ğŸ”¹ Ver antivirus y firewall activos

Get-CimInstance -Namespace root\SecurityCenter2 -ClassName AntiVirusProduct |
Select-Object displayName, pathToSignedProductExe, productState
Get-CimInstance -Namespace root\SecurityCenter2 -ClassName FirewallProduct
ğŸ”¹ Detectar cuentas sin cambio de contraseÃ±a

Get-CimInstance Win32_UserAccount -Filter "PasswordChangeable='True'" |
Select-Object Name, PasswordAge

ğŸ–¥ï¸ 6. GestiÃ³n remota y despliegue
ğŸ”¹ Ejecutar comando remoto vÃ­a WMI

Invoke-WmiMethod -Class Win32_Process -Name Create -ArgumentList "notepad.exe" -ComputerName PC002
ğŸ”¹ Copiar archivo a varios equipos

$pcs = Get-Content .\lista_pc.txt
foreach ($pc in $pcs) {
    Copy-Item "C:\instaladores\agent.msi" "\\$pc\C$\temp\" -Force
}
ğŸ”¹ Instalar software remoto con WMI

Invoke-WmiMethod -ComputerName PC002 -Class Win32_Product -Name Install -ArgumentList "msiexec /i \\server\share\app.msi /qn"

ğŸ”„ 7. AutomatizaciÃ³n avanzada / scripts programados
ğŸ”¹ Crear un reporte automÃ¡tico diario

$report = "C:\Reports\DailyStatus_$(Get-Date -Format 'yyyyMMdd').txt"
"Hostname: $env:COMPUTERNAME" | Out-File $report
"Uptime: $((Get-Date) - (Get-CimInstance Win32_OperatingSystem).LastBootUpTime)" | Out-File $report -Append
"Free disk space:" | Out-File $report -Append
Get-CimInstance Win32_LogicalDisk | Select-Object DeviceID,FreeSpace | Out-File $report -Append
ğŸ”¹ Programar tareas WMI

$action = New-ScheduledTaskAction -Execute "PowerShell.exe" -Argument "-File C:\Scripts\DailyCheck.ps1"
$trigger = New-ScheduledTaskTrigger -Daily -At 9am
Register-ScheduledTask -Action $action -Trigger $trigger -TaskName "Daily System Check"

ğŸ“¦ 8. AuditorÃ­a y compliance
ğŸ”¹ Listar actualizaciones instaladas

Get-CimInstance Win32_QuickFixEngineering | Select HotFixID, InstalledOn, Description
ğŸ”¹ Revisar polÃ­ticas locales

Get-CimInstance Win32_GroupPolicyObject | Select DisplayName, Enabled
ğŸ”¹ Detectar si BitLocker estÃ¡ activo

Get-BitLockerVolume | Select MountPoint, VolumeStatus, EncryptionPercentage

ğŸš€ Consejo final:
Para exploraciÃ³n interactiva:

Get-CimClass | Where-Object CimClassName -like "*network*" | Select CimClassName